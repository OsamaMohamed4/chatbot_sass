{"timestamp": 1761488610.2791948, "level": "ERROR", "name": "api", "message": "Request failed: 'coroutine' object has no attribute 'get'", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 264, in app\n    solved_result = await solve_dependencies(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/dependencies/utils.py\", line 592, in solve_dependencies\n    solved = await call(**sub_values)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/deps.py\", line 38, in get_current_admin\n    if token_data.get(\"user_type\") != \"admin\":\n       ^^^^^^^^^^^^^^\nAttributeError: 'coroutine' object has no attribute 'get'", "request_id": "33b33bd0-32b2-43e5-a8b9-86276f221cc7", "method": "POST", "path": "/api/v1/companies", "logger": "api", "environment": "development"}
{"timestamp": 1761489789.9520855, "level": "ERROR", "name": "api", "message": "Request failed: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: operator does not exist: integer = character varying\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n[SQL: SELECT system_admins.username, system_admins.email, system_admins.password_hash, system_admins.first_name, system_admins.last_name, system_admins.is_superuser, system_admins.last_login_at, system_admins.failed_login_attempts, system_admins.locked_until, system_admins.two_factor_enabled, system_admins.two_factor_secret, system_admins.id, system_admins.is_active, system_admins.created_at, system_admins.updated_at \nFROM system_admins \nWHERE system_admins.id = $1::VARCHAR AND system_admins.is_active = true]\n[parameters: ('1',)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 533, in _prepare_and_execute\n    prepared_stmt, attributes = await adapt_connection._prepare(\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 784, in _prepare\n    prepared_stmt = await self._connection.prepare(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/connection.py\", line 636, in prepare\n    return await self._prepare(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/connection.py\", line 654, in _prepare\n    stmt = await self._get_statement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/connection.py\", line 433, in _get_statement\n    statement = await self._protocol.prepare(\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 166, in prepare\nasyncpg.exceptions.UndefinedFunctionError: operator does not exist: integer = character varying\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedFunctionError'>: operator does not exist: integer = character varying\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 264, in app\n    solved_result = await solve_dependencies(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/dependencies/utils.py\", line 592, in solve_dependencies\n    solved = await call(**sub_values)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/deps.py\", line 47, in get_current_admin\n    result = await db.execute(\n             ^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: operator does not exist: integer = character varying\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n[SQL: SELECT system_admins.username, system_admins.email, system_admins.password_hash, system_admins.first_name, system_admins.last_name, system_admins.is_superuser, system_admins.last_login_at, system_admins.failed_login_attempts, system_admins.locked_until, system_admins.two_factor_enabled, system_admins.two_factor_secret, system_admins.id, system_admins.is_active, system_admins.created_at, system_admins.updated_at \nFROM system_admins \nWHERE system_admins.id = $1::VARCHAR AND system_admins.is_active = true]\n[parameters: ('1',)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "request_id": "4209411d-8b99-4872-8c27-e8b53596da9a", "method": "POST", "path": "/api/v1/companies", "logger": "api", "environment": "development"}
{"timestamp": 1761595080.1068347, "level": "ERROR", "name": "api", "message": "Request failed: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: operator does not exist: integer = character varying\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n[SQL: SELECT system_admins.username, system_admins.email, system_admins.password_hash, system_admins.first_name, system_admins.last_name, system_admins.is_superuser, system_admins.last_login_at, system_admins.failed_login_attempts, system_admins.locked_until, system_admins.two_factor_enabled, system_admins.two_factor_secret, system_admins.id, system_admins.is_active, system_admins.created_at, system_admins.updated_at \nFROM system_admins \nWHERE system_admins.id = $1::VARCHAR AND system_admins.is_active = true]\n[parameters: ('1',)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 533, in _prepare_and_execute\n    prepared_stmt, attributes = await adapt_connection._prepare(\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 784, in _prepare\n    prepared_stmt = await self._connection.prepare(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/connection.py\", line 636, in prepare\n    return await self._prepare(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/connection.py\", line 654, in _prepare\n    stmt = await self._get_statement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/connection.py\", line 433, in _get_statement\n    statement = await self._protocol.prepare(\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 166, in prepare\nasyncpg.exceptions.UndefinedFunctionError: operator does not exist: integer = character varying\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedFunctionError'>: operator does not exist: integer = character varying\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 264, in app\n    solved_result = await solve_dependencies(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/dependencies/utils.py\", line 592, in solve_dependencies\n    solved = await call(**sub_values)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/deps.py\", line 47, in get_current_admin\n    result = await db.execute(\n             ^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: operator does not exist: integer = character varying\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n[SQL: SELECT system_admins.username, system_admins.email, system_admins.password_hash, system_admins.first_name, system_admins.last_name, system_admins.is_superuser, system_admins.last_login_at, system_admins.failed_login_attempts, system_admins.locked_until, system_admins.two_factor_enabled, system_admins.two_factor_secret, system_admins.id, system_admins.is_active, system_admins.created_at, system_admins.updated_at \nFROM system_admins \nWHERE system_admins.id = $1::VARCHAR AND system_admins.is_active = true]\n[parameters: ('1',)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "request_id": "f5789ed9-1956-4018-9e71-a0cbf96c24d2", "method": "POST", "path": "/api/v1/companies", "logger": "api", "environment": "development"}
{"timestamp": 1761595510.8744001, "level": "ERROR", "name": "api", "message": "Request failed: 2 validation errors for CompanyResponse\nresource_plan\n  Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<app.models.client_compan...bject at 0x7cdd7cb94c10>, input_type=ClientCompany]\n    For further information visit https://errors.pydantic.dev/2.11/v/get_attribute_error\nresource_allocation\n  Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<app.models.client_compan...bject at 0x7cdd7cb94c10>, input_type=ClientCompany]\n    For further information visit https://errors.pydantic.dev/2.11/v/get_attribute_error", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/companies.py\", line 46, in create_company\n    data=CompanyResponse.model_validate(company),\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/pydantic/main.py\", line 705, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 2 validation errors for CompanyResponse\nresource_plan\n  Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<app.models.client_compan...bject at 0x7cdd7cb94c10>, input_type=ClientCompany]\n    For further information visit https://errors.pydantic.dev/2.11/v/get_attribute_error\nresource_allocation\n  Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<app.models.client_compan...bject at 0x7cdd7cb94c10>, input_type=ClientCompany]\n    For further information visit https://errors.pydantic.dev/2.11/v/get_attribute_error", "request_id": "3fa5e9a4-2ca4-44a9-97b5-d46239e39f31", "method": "POST", "path": "/api/v1/companies", "logger": "api", "environment": "development"}
{"timestamp": 1761595887.1385984, "level": "ERROR", "name": "api", "message": "Request failed: Company with name 'mdarj' already exists", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/companies.py\", line 44, in create_company\n    company = await service.create_company(company_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/company_service.py\", line 31, in create_company\n    raise DuplicateResourceException(\napp.exceptions.base_exception.DuplicateResourceException: Company with name 'mdarj' already exists", "request_id": "5c20e643-e360-47c9-981d-fd1f5268c4eb", "method": "POST", "path": "/api/v1/companies", "logger": "api", "environment": "development"}
{"timestamp": 1761595997.5596046, "level": "ERROR", "name": "api", "message": "Request failed: Company with email 'mdarj@gmail.com' already exists", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/companies.py\", line 44, in create_company\n    company = await service.create_company(company_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/company_service.py\", line 40, in create_company\n    raise DuplicateResourceException(\napp.exceptions.base_exception.DuplicateResourceException: Company with email 'mdarj@gmail.com' already exists", "request_id": "21943bc0-83d3-4adf-be80-f00f81412400", "method": "POST", "path": "/api/v1/companies", "logger": "api", "environment": "development"}
{"timestamp": 1761688394.1879082, "level": "ERROR", "name": "api", "message": "Request failed: 'widget_position' is an invalid keyword argument for Website", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/websites.py\", line 62, in create_website\n    website = await service.create_website(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/website_service.py\", line 97, in create_website\n    website = await self.website_repo.create(website_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/repositories/base_repository.py\", line 59, in create\n    db_obj = self.model(**obj_in)\n             ^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 566, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 564, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2142, in _declarative_constructor\n    raise TypeError(\nTypeError: 'widget_position' is an invalid keyword argument for Website", "request_id": "92dffdcb-e018-41ce-b566-bcb96f141653", "method": "POST", "path": "/api/v1/websites", "logger": "api", "environment": "development"}
{"timestamp": 1761688394.3306513, "level": "ERROR", "name": "app.middleware.error_handler", "message": "Unhandled Exception: 'widget_position' is an invalid keyword argument for Website", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 132, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/websites.py\", line 62, in create_website\n    website = await service.create_website(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/website_service.py\", line 97, in create_website\n    website = await self.website_repo.create(website_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/repositories/base_repository.py\", line 59, in create\n    db_obj = self.model(**obj_in)\n             ^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 566, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 564, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2142, in _declarative_constructor\n    raise TypeError(\nTypeError: 'widget_position' is an invalid keyword argument for Website", "path": "/api/v1/websites", "exception_type": "TypeError", "logger": "app.middleware.error_handler", "environment": "development"}
{"timestamp": 1761744948.0306711, "level": "ERROR", "name": "api", "message": "Request failed: 'widget_position' is an invalid keyword argument for Website", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/websites.py\", line 62, in create_website\n    website = await service.create_website(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/website_service.py\", line 97, in create_website\n    website = await self.website_repo.create(website_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/repositories/base_repository.py\", line 59, in create\n    db_obj = self.model(**obj_in)\n             ^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 566, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 564, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2142, in _declarative_constructor\n    raise TypeError(\nTypeError: 'widget_position' is an invalid keyword argument for Website", "request_id": "7ad16190-bd69-46b9-98f8-0d4ec1208721", "method": "POST", "path": "/api/v1/websites", "logger": "api", "environment": "development"}
{"timestamp": 1761744948.3329208, "level": "ERROR", "name": "app.middleware.error_handler", "message": "Unhandled Exception: 'widget_position' is an invalid keyword argument for Website", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 132, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/websites.py\", line 62, in create_website\n    website = await service.create_website(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/website_service.py\", line 97, in create_website\n    website = await self.website_repo.create(website_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/repositories/base_repository.py\", line 59, in create\n    db_obj = self.model(**obj_in)\n             ^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 566, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 564, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2142, in _declarative_constructor\n    raise TypeError(\nTypeError: 'widget_position' is an invalid keyword argument for Website", "path": "/api/v1/websites", "exception_type": "TypeError", "logger": "app.middleware.error_handler", "environment": "development"}
{"timestamp": 1761745162.1413853, "level": "ERROR", "name": "api", "message": "Request failed: 'widget_position' is an invalid keyword argument for Website", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/websites.py\", line 62, in create_website\n    website = await service.create_website(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/website_service.py\", line 97, in create_website\n    website = await self.website_repo.create(website_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/repositories/base_repository.py\", line 59, in create\n    db_obj = self.model(**obj_in)\n             ^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 566, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 564, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2142, in _declarative_constructor\n    raise TypeError(\nTypeError: 'widget_position' is an invalid keyword argument for Website", "request_id": "a075a5b2-6e80-4eca-a2bf-fdc3d44252e4", "method": "POST", "path": "/api/v1/websites", "logger": "api", "environment": "development"}
{"timestamp": 1761745162.2872837, "level": "ERROR", "name": "app.middleware.error_handler", "message": "Unhandled Exception: 'widget_position' is an invalid keyword argument for Website", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 132, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/websites.py\", line 62, in create_website\n    website = await service.create_website(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/website_service.py\", line 97, in create_website\n    website = await self.website_repo.create(website_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/repositories/base_repository.py\", line 59, in create\n    db_obj = self.model(**obj_in)\n             ^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 566, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 564, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2142, in _declarative_constructor\n    raise TypeError(\nTypeError: 'widget_position' is an invalid keyword argument for Website", "path": "/api/v1/websites", "exception_type": "TypeError", "logger": "app.middleware.error_handler", "environment": "development"}
{"timestamp": 1761748891.7838125, "level": "ERROR", "name": "api", "message": "Request failed: 'widget_color' is an invalid keyword argument for Website", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/websites.py\", line 62, in create_website\n    website = await service.create_website(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/website_service.py\", line 97, in create_website\n    website = await self.website_repo.create(website_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/repositories/base_repository.py\", line 59, in create\n    db_obj = self.model(**obj_in)\n             ^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 566, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 564, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2142, in _declarative_constructor\n    raise TypeError(\nTypeError: 'widget_color' is an invalid keyword argument for Website", "request_id": "b531ec0a-edeb-44b4-914d-0a994a71fafb", "method": "POST", "path": "/api/v1/websites", "logger": "api", "environment": "development"}
{"timestamp": 1761745216.0043383, "level": "ERROR", "name": "app.middleware.error_handler", "message": "Unhandled Exception: 'widget_color' is an invalid keyword argument for Website", "exc_info": "Traceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 132, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/websites.py\", line 62, in create_website\n    website = await service.create_website(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/website_service.py\", line 97, in create_website\n    website = await self.website_repo.create(website_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/repositories/base_repository.py\", line 59, in create\n    db_obj = self.model(**obj_in)\n             ^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 566, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 564, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2142, in _declarative_constructor\n    raise TypeError(\nTypeError: 'widget_color' is an invalid keyword argument for Website", "path": "/api/v1/websites", "exception_type": "TypeError", "logger": "app.middleware.error_handler", "environment": "development"}
{"timestamp": 1761747971.708854, "level": "ERROR", "name": "api", "message": "Request failed: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: HttpUrl('https://example.com/') (expected str, got HttpUrl)\n[SQL: INSERT INTO websites (website_name, website_url, domain, description, widget_color, widget_size, widget_position, widget_icon, placeholder_text, show_powered_by, custom_css, auto_open_delay, enable_sound, enable_file_upload, allowed_file_types, widget_status, business_hours_enabled, business_hours, welcome_message, offline_message, domain_verified, verified_at, allowed_domains, widget_api_key, total_visitors, total_conversations, conversion_rate, embed_code, api_endpoint, webhook_url, is_active, company_id, primary_ai_model_id, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::BOOLEAN, $11::VARCHAR, $12::INTEGER, $13::BOOLEAN, $14::BOOLEAN, $15::JSON, $16::VARCHAR, $17::BOOLEAN, $18::JSON, $19::VARCHAR, $20::VARCHAR, $21::BOOLEAN, $22::TIMESTAMP WITHOUT TIME ZONE, $23::JSON, $24::VARCHAR, $25::INTEGER, $26::INTEGER, $27::INTEGER, $28::VARCHAR, $29::VARCHAR, $30::VARCHAR, $31::BOOLEAN, $32::INTEGER, $33::INTEGER, $34::TIMESTAMP WITH TIME ZONE) RETURNING websites.id, websites.created_at]\n[parameters: ('my test website', HttpUrl('https://example.com/'), 'example.com', 'string', '#0084ff', 'medium', 'bottom-right', None, 'Type your message...', True, None, None, True, False, '[]', 'active', False, '{}', 'string', 'string', False, None, '[]', None, 0, 0, None, '<script src=\"/widget.js\" data-widget-id=\"ZBX6O7mIzN5Nn5a0\"></script>', '/api/v1/chat/widget/1', None, True, 1, None, None)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "exc_info": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got HttpUrl\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: HttpUrl('https://example.com/') (expected str, got HttpUrl)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: HttpUrl('https://example.com/') (expected str, got HttpUrl)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/websites.py\", line 62, in create_website\n    website = await service.create_website(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/website_service.py\", line 97, in create_website\n    website = await self.website_repo.create(website_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/repositories/base_repository.py\", line 61, in create\n    await self.db.flush()\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 802, in flush\n    await greenlet_spawn(self.sync_session.flush, objects=objects)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 192, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4312, in flush\n    self._flush(objects)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4447, in _flush\n    with util.safe_reraise():\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4408, in _flush\n    flush_context.execute()\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1226, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: HttpUrl('https://example.com/') (expected str, got HttpUrl)\n[SQL: INSERT INTO websites (website_name, website_url, domain, description, widget_color, widget_size, widget_position, widget_icon, placeholder_text, show_powered_by, custom_css, auto_open_delay, enable_sound, enable_file_upload, allowed_file_types, widget_status, business_hours_enabled, business_hours, welcome_message, offline_message, domain_verified, verified_at, allowed_domains, widget_api_key, total_visitors, total_conversations, conversion_rate, embed_code, api_endpoint, webhook_url, is_active, company_id, primary_ai_model_id, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::BOOLEAN, $11::VARCHAR, $12::INTEGER, $13::BOOLEAN, $14::BOOLEAN, $15::JSON, $16::VARCHAR, $17::BOOLEAN, $18::JSON, $19::VARCHAR, $20::VARCHAR, $21::BOOLEAN, $22::TIMESTAMP WITHOUT TIME ZONE, $23::JSON, $24::VARCHAR, $25::INTEGER, $26::INTEGER, $27::INTEGER, $28::VARCHAR, $29::VARCHAR, $30::VARCHAR, $31::BOOLEAN, $32::INTEGER, $33::INTEGER, $34::TIMESTAMP WITH TIME ZONE) RETURNING websites.id, websites.created_at]\n[parameters: ('my test website', HttpUrl('https://example.com/'), 'example.com', 'string', '#0084ff', 'medium', 'bottom-right', None, 'Type your message...', True, None, None, True, False, '[]', 'active', False, '{}', 'string', 'string', False, None, '[]', None, 0, 0, None, '<script src=\"/widget.js\" data-widget-id=\"ZBX6O7mIzN5Nn5a0\"></script>', '/api/v1/chat/widget/1', None, True, 1, None, None)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "f3394af9-1a85-404f-9d17-4da2a62c7e08", "method": "POST", "path": "/api/v1/websites", "logger": "api", "environment": "development"}
{"timestamp": 1761747971.8285034, "level": "ERROR", "name": "app.middleware.error_handler", "message": "Unhandled Exception: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: HttpUrl('https://example.com/') (expected str, got HttpUrl)\n[SQL: INSERT INTO websites (website_name, website_url, domain, description, widget_color, widget_size, widget_position, widget_icon, placeholder_text, show_powered_by, custom_css, auto_open_delay, enable_sound, enable_file_upload, allowed_file_types, widget_status, business_hours_enabled, business_hours, welcome_message, offline_message, domain_verified, verified_at, allowed_domains, widget_api_key, total_visitors, total_conversations, conversion_rate, embed_code, api_endpoint, webhook_url, is_active, company_id, primary_ai_model_id, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::BOOLEAN, $11::VARCHAR, $12::INTEGER, $13::BOOLEAN, $14::BOOLEAN, $15::JSON, $16::VARCHAR, $17::BOOLEAN, $18::JSON, $19::VARCHAR, $20::VARCHAR, $21::BOOLEAN, $22::TIMESTAMP WITHOUT TIME ZONE, $23::JSON, $24::VARCHAR, $25::INTEGER, $26::INTEGER, $27::INTEGER, $28::VARCHAR, $29::VARCHAR, $30::VARCHAR, $31::BOOLEAN, $32::INTEGER, $33::INTEGER, $34::TIMESTAMP WITH TIME ZONE) RETURNING websites.id, websites.created_at]\n[parameters: ('my test website', HttpUrl('https://example.com/'), 'example.com', 'string', '#0084ff', 'medium', 'bottom-right', None, 'Type your message...', True, None, None, True, False, '[]', 'active', False, '{}', 'string', 'string', False, None, '[]', None, 0, 0, None, '<script src=\"/widget.js\" data-widget-id=\"ZBX6O7mIzN5Nn5a0\"></script>', '/api/v1/chat/widget/1', None, True, 1, None, None)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "exc_info": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got HttpUrl\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: HttpUrl('https://example.com/') (expected str, got HttpUrl)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: HttpUrl('https://example.com/') (expected str, got HttpUrl)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 132, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/middleware/request_logging.py\", line 35, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/api/v1/websites.py\", line 62, in create_website\n    website = await service.create_website(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/services/website_service.py\", line 97, in create_website\n    website = await self.website_repo.create(website_data)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/d/chatbot/app/repositories/base_repository.py\", line 61, in create\n    await self.db.flush()\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 802, in flush\n    await greenlet_spawn(self.sync_session.flush, objects=objects)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 192, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4312, in flush\n    self._flush(objects)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4447, in _flush\n    with util.safe_reraise():\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4408, in _flush\n    flush_context.execute()\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1226, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/home/osama_mohamed/miniconda3/envs/chatbot/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: HttpUrl('https://example.com/') (expected str, got HttpUrl)\n[SQL: INSERT INTO websites (website_name, website_url, domain, description, widget_color, widget_size, widget_position, widget_icon, placeholder_text, show_powered_by, custom_css, auto_open_delay, enable_sound, enable_file_upload, allowed_file_types, widget_status, business_hours_enabled, business_hours, welcome_message, offline_message, domain_verified, verified_at, allowed_domains, widget_api_key, total_visitors, total_conversations, conversion_rate, embed_code, api_endpoint, webhook_url, is_active, company_id, primary_ai_model_id, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::BOOLEAN, $11::VARCHAR, $12::INTEGER, $13::BOOLEAN, $14::BOOLEAN, $15::JSON, $16::VARCHAR, $17::BOOLEAN, $18::JSON, $19::VARCHAR, $20::VARCHAR, $21::BOOLEAN, $22::TIMESTAMP WITHOUT TIME ZONE, $23::JSON, $24::VARCHAR, $25::INTEGER, $26::INTEGER, $27::INTEGER, $28::VARCHAR, $29::VARCHAR, $30::VARCHAR, $31::BOOLEAN, $32::INTEGER, $33::INTEGER, $34::TIMESTAMP WITH TIME ZONE) RETURNING websites.id, websites.created_at]\n[parameters: ('my test website', HttpUrl('https://example.com/'), 'example.com', 'string', '#0084ff', 'medium', 'bottom-right', None, 'Type your message...', True, None, None, True, False, '[]', 'active', False, '{}', 'string', 'string', False, None, '[]', None, 0, 0, None, '<script src=\"/widget.js\" data-widget-id=\"ZBX6O7mIzN5Nn5a0\"></script>', '/api/v1/chat/widget/1', None, True, 1, None, None)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "path": "/api/v1/websites", "exception_type": "DBAPIError", "logger": "app.middleware.error_handler", "environment": "development"}
